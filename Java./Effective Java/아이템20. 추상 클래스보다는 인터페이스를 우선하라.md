# 0. Overview

이펙티브 자바 **아이템20. 추상 클래스보다는 인터페이스를 우선하라**를 보고 공부한 내용을 정리했다.

일반적으로 다중 구현용 타입으로는 인터페이스가 가장 적합하다.

복잡한 인터페이스라면 구현하는 수고를 덜어주는 골격 구현을 함께 제공하는 방법을 꼭 고려해보자.

골격 구현은 가능한 한 인터페이스의 디폴트 메소드로 제공하여 그 인터페이스를 구현한 모든 곳에서 활용하도록 하는 것이 좋다.

# 1. 다중 구현 : 인터페이스 vs 추상 클래스

자바가 제공하는 다중 구현 메커니즘은 인터페이스와 추상 클래스 두 가지다.

자바 8부터 인터페이스도 디폴트 메소드를 제공할 수 있게 되어 이제는 두 가지 모두 인스턴스 메소드를 구현 형태로 제공할 수 있다.

둘의 가장 큰 차이는 추상 클래스가 정의한 타입을 구현하는 클래스는 반드시 추상 클래스의 하위 클래스가 되어야 한다는 점이다.

두 클래스가 같은 추상 클래스를 확장하길 원한다면 추상 클래스는 계층구조 상 두 클래스의 공통 조상이어야 한다. 안타깝게도 이 방식은 클래스 계층구조에 커다란 혼란을 일으킨다.

반면 인터페이스는 선언한 메소드를 모두 정의하면 다른 어떤 클래스를 상속했든 같은 타입으로 취급된다.

즉, 기존 클래스에도 손쉽게 새로운 인터페이스를 구현해넣을 수 있다. `implements` 구문만 추가하면 끝이다.

# 2. 믹스인(mixin)

인터페이스는 믹스인 정의에 안성맞춤이다. 믹스인은 대상 타입의 주된 기능에 선택정 기능을 혼합한다고 해서 믹스인이라 부른다.

믹스인을 구현한 클래스는 원래 주된 타입 외에도 특정 선택적 행위를 제공한다.

추상 클래스는 믹스인을 정의할 수 없다. 이유는 앞서와 같이 기존 클래스에 덧씌울 수 없기 때문이다.

클래스가 두 부모를 섬길 수 없고, 클래스 계층구조에는 믹스인을 삽입하기에 합리적인 위치가 없기 때문이다.

# 3. 계층구조가 없는 타입 프레임워크

타입을 계층적으로 정의하면 수많은 개념을 구조적으로 잘 표현할 수 있지만, 현실에는 계층을 엄격히 구분하기 어려운 개념도 있다.

```java
public interface Singer {
    AudioClip sing(Song s);
}

public interface Songwriter {
    Song compose(int charPosition);
}
```

가수 인터페이스와 작곡가 인터페이스를 정의했다.

우리 주변엔 작곡도 하는 가수가 제법 있으니 SingerSongwriter를 정의해보겠다.

```java
public interface SingerSongwirter extends Singer, Songwriter {
    AudioClip strum();
    void actSensitive();
}
```

이와 같은 구조를 클래스로 만들려면 가능한 조합 전부를 각각의 클래스로 정의한 고도비만 계층구조가 만들어질 것이다.

거대한 클래스 계층구조에는 공통 기능을 정의해놓은 타입이 없으니, 자칫 매개변수 타입만 다른 메소드들을 수없이 많이 가질 수 있다.

# 4. 인터페이스의 구현 방법

## 4.1 디폴트 메소드

인터페이스의 메소드 중 구현 방법이 명백한 것이 있다면, 그 구현을 디폴트 메소드로 제공해 일감을 덜어줄 수 있다.

디폴트 메소드를 제공할 때는 상속하려는 사람을 위한 설명을 `@implSpec` 태그를 붙여 문서화해야 한다.

디폴트 메소드에도 제약은 있다. 많은 인터페이스가 `equals`와 `hasCode` 같은 Object의 메소드를 정의하고 있지만, 이들은 디폴트 메소드로 제공해서는 안된다.

또한 인터페이스는 인스턴스 필드를 가질 수 없고 정적 멤버도 가질 수 없다.

## 4.2 템플릿 메소드 패턴 - 추상 골격 구현 클래스를 함께 제공

인터페이스와 추상 골격 구현 클래스를 함께 제공하는 식으로 인터페이스와 추상 클래스의 장점을 모두 취하는 방법도 있다.

인터페이스로는 타입을 정의하고, 필요하면 디폴트 메소드 몇 개도 함께 제공한다. 그리고 골격 구현 클래스는 나머지 메소드들까지 구현한다.

이렇게 해두면 단순히 골격 구현을 확장하는 것만으로 이 인터페이스를 구현하는 데 필요한 일이 대부분 완료된다.

관례상 인터페이스 이름이 Interface라면 골격 구현 클래스의 이름은 AbsractInterface로 짓는다.

골격 구현 클래스의 장점은 추상 클래스처럼 구현을 도와주는 동시에, 추상 클래스로 타입을 정의할 때 따라오는 심각한 제약에서는 자유롭다는 점이다.

골격 구현은 기본적으로 상속해서 사용하는 걸 가정하므로 상속을 고려한 설계 및 문서화 지침을 모두 따라야 한다.